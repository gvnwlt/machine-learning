install.packages("caret")
setwd("~/R/poker/")
train <- read.csv("train.csv")
test <- read.csv("test.csv")
t_lab <- as.factor(train$hand)
te_lab <- as.factor(test$hand)
library(nnet)
train_sample <- train[1:18000, ]
t_lab <- t_lab[1:18000]
fit <- nnet(t_lab ~ ., data = train_sample, size = 6, decay = 5e-4)
pred <- predict(fit, test, type = "class")
library(caret)
results <- table(pred = pred, true = te_lab)
results
u <- union(pred, factor(te_lab))
t <- table(factor(pred, u), factor(te_lab, u))
confusionMatrix(t)
fit <- nnet(t_lab ~ ., data = train_sample, size = 6, decay = 5e-4, softmax = TRUE)
fit <- nnet(t_lab ~ ., data = train_sample, size = 3, decay = 5e-4)
pred <- predict(fit, test, type = "class")
results <- table(pred = pred, true = te_lab)
results
u <- union(pred, factor(te_lab))
t <- table(factor(pred, u), factor(te_lab, u))
confusionMatrix(t)
fit <- nnet(t_lab ~ ., data = train_sample, size = 1, decay = 5e-4)
pred <- predict(fit, test, type = "class")
results <- table(pred = pred, true = te_lab)
u <- union(pred, factor(te_lab))
t <- table(factor(pred, u), factor(te_lab, u))
confusionMatrix(t)
test2 <- test[1:10, ]
pred <- predict(fit, test2, type = "class")
results <- table(pred = pred, true = te_lab)
te_lab2 <- te_lab[1:18000,]
te_lab2 <- te_lab[1:18000]
results <- table(pred = pred, true = te_lab2)
fit <- nnet(t_lab ~ ., data = train_sample, size = 7, decay = 5e-4)
pred <- predict(fit, test, type = "class")
results <- table(pred = pred, true = te_lab)
u <- union(pred, factor(te_lab))
t <- table(factor(pred, u), factor(te_lab, u))
confusionMatrix(t)
fit <- nnet(t_lab ~ ., data = train_sample, size = 10, decay = 5e-4)
pred <- predict(fit, test, type = "class")
results <- table(pred = pred, true = te_lab)
u <- union(pred, factor(te_lab))
t <- table(factor(pred, u), factor(te_lab, u))
confusionMatrix(t)
fit <- nnet(t_lab ~ ., data = train_sample, size = 20, decay = 5e-4)
pred <- predict(fit, test, type = "class")
results <- table(pred = pred, true = te_lab)
u <- union(pred, factor(te_lab))
t <- table(factor(pred, u), factor(te_lab, u))
confusionMatrix(t)
fit <- nnet(t_lab ~ ., data = train_sample, size = 30, decay = 5e-4)
pred <- predict(fit, test, type = "class")
results <- table(pred = pred, true = te_lab)
u <- union(pred, factor(te_lab))
t <- table(factor(pred, u), factor(te_lab, u))
confusionMatrix(t)
